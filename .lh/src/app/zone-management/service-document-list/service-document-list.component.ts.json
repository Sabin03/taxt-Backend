{
    "sourceFile": "src/app/zone-management/service-document-list/service-document-list.component.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1722265332321,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1722265332321,
            "name": "Commit-0",
            "content": "import { Component, ViewChild } from '@angular/core';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { MatSort } from '@angular/material/sort';\nimport { ZoneList } from '../../model/zone-list';\nimport { Service } from '../../model/service';\nimport { MatTableDataSource } from '@angular/material/table';\nimport { WebService } from '../../web.service';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Common } from '../../common';\nimport { ZoneDocument } from '../../model/zone-document';\nimport { ServiceDocumentEditComponent } from '../service-document-edit/service-document-edit.component';\n\n@Component({\n  selector: 'app-service-document-list',\n  templateUrl: './service-document-list.component.html',\n  styleUrl: './service-document-list.component.css'\n})\nexport class ServiceDocumentListComponent {\n\n  @ViewChild(MatPaginator) paginator!: MatPaginator;\n  @ViewChild(MatSort) sort!: MatSort;\n\n\n  zone_id = \"\";\n  service_id = \"\";\n  selectZoneObj: ZoneList = new ZoneList();\n  selectServiceObj: Service = new Service();\n\n  zoneArr: Array<ZoneList> = [];\n  serviceArr: Array<Service> = [];\n  documentArr: Array<Document> = [];\n\n  displayedColumns: string[] = ['no', 'zone_name', 'service_name', 'personDocument', 'carDocument', 'action']\n  listArray: Array<ZoneDocument> = [];\n  dataSource: MatTableDataSource<ZoneDocument> = new MatTableDataSource<ZoneDocument>();\n\n\n  constructor(private webService: WebService, public snackBar: MatSnackBar, public dialog: MatDialog) {\n\n  }\n\n  ngOnInit(): void {\n    this.getServiceList();\n    this.getList();\n  }\n\n  ngAfterViewInit(): void {\n    this.dataSource.paginator = this.paginator;\n    this.dataSource.sort = this.sort;\n  }\n\n\n  applyFilter(filterValue: string) {\n    this.dataSource.filter = filterValue.trim().toLowerCase();\n    if (this.dataSource.paginator) {\n      this.dataSource.paginator.firstPage();\n    }\n  }\n\n  openSnackBar(message: string) {\n    this.snackBar.open(message, \"ok\", {\n      duration: 2000,\n    });\n  }\n\n\n\n  openDialogEdit(obj: ZoneDocument) {\n    const dialogRef = this.dialog.open(ServiceDocumentEditComponent, {\n      width: '400px',\n      data: {\n        'edit': obj,\n        'doc': this.documentArr,\n      }\n    })\n    dialogRef.afterClosed().subscribe((updateInfo) => {\n      Common.Dlog(updateInfo);\n      if (updateInfo) {\n        const index = this.listArray.findIndex(item => item.zone_doc_id == updateInfo.zone_doc_id);\n        this.listArray[index] = updateInfo;\n        this.dataSource = new MatTableDataSource(this.listArray);\n        this.dataSource.paginator = this.paginator;\n        this.dataSource.sort = this.sort;\n      }\n    })\n  }\n\n\n\n  onSelectZone(zObj: ZoneList) {\n    this.zone_id = zObj.zone_id.toString();\n    this.service_id = '';\n    this.selectServiceObj = new Service();\n    this.getList();\n\n  }\n\n  onSelectService(sObj: Service) {\n    this.service_id = sObj.service_id.toString();\n    this.getList();\n  }\n\n  clear(){\n    this.zone_id = \"\";\n    this.service_id = \"\";\n    this.selectZoneObj = new ZoneList();\n    this.selectServiceObj = new Service();\n    this.getList();\n  }\n\n\n  getServiceList() {\n\n\n    this.webService.action(Common.svZoneServiceList, {}, true).then((responseObj: any) => {\n\n      Common.Dlog(responseObj);\n      if (responseObj.status == 1) {\n        this.zoneArr = responseObj.payload.zone_list;\n        this.serviceArr = responseObj.payload.service_list;\n      }\n\n    })\n  }\n\n  getList() {\n\n    var paraObj: any = {};\n\n    if (this.zone_id != \"\") {\n      paraObj[\"zone_id\"] = this.zone_id;\n    }\n\n    if (this.service_id != '') {\n      paraObj[\"service_id\"] = this.service_id;\n    }\n\n\n    this.webService.action(Common.svZoneServiceDocument, paraObj, true).then((responseObj: any) => {\n\n      Common.Dlog(responseObj);\n      if (responseObj.status == 1) {\n        this.listArray = responseObj.payload;\n      } else {\n        this.listArray = [];\n        this.openSnackBar(responseObj.message);\n      }\n      this.documentArr = responseObj.document_list;\n\n      this.dataSource = new MatTableDataSource(this.listArray);\n      this.dataSource.paginator = this.paginator;\n      this.dataSource.sort = this.sort;\n\n    })\n  }\n\n}\n"
        }
    ]
}